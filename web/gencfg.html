<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <title>rism0</title>
  <link rel="stylesheet" type="text/css" href="css/default.css">
  <script src="js/util.js"></script>
  <script src="js/gencfg.js"></script>
</head>
<body onload="init()">

<h2 class="center">
  Configuration file generator for the XRISM program <span class="code">rism0</span>
</h2>

<form>
  <div style="font-size:120%; text-align:center">
    E<b>x</b>tended <b>R</b>eference <b>I</b>nteraction <b>S</b>ite <b>M</b>odel (XRISM)
    parameters
  </div>
  <br>

  <div class="panel">
  <div class="panel-title">System</div>

  Number of sites (on all solvent and solute molecules):
  <input type="text" size="4" value="3" id="ns"
    onchange="change_ns()">
  <br>

  <table id="siteTable">
    <tr id="siteTableHeader">
      <th>
        Site #
      </th>
      <th>
        <span class="math"><i>&sigma;</i></span>
        (&#197;)
      </th>
      <th>
        <span class="math"><i>&epsilon;</i><sub>&#8326;</sub></span>
        (<select id="unit_eps6" onchange="change_unit_eps()">
          <option value="reduced">reduced</option>
          <option value="K" selected>K</option>
          <option value="erg">erg</option>
          <option value="kJpermol">kJ/mol</option>
          <option value="kcalpermol">kcal/mol</option>
        </select>)
      </th>
      <th>
        <span class="math"><i>&epsilon;</i><sub>&#8321;&#8322;</sub></span>
        (<select id="unit_eps12" disabled>
          <option value="reduced">reduced</option>
          <option value="K" selected>K</option>
          <option value="erg">erg</option>
          <option value="kJpermol">kJ/mol</option>
          <option value="kcalpermol">kcal/mol</option>
        </select>)<br>
      </th>
      <th>
        <span class="math"><i>&rho;</i></span>
        (<select id="unit_rho">
          <option value="molperA3" selected>molecules/&#197;&#179;</option>
          <option value="gpercm3" disabled>g/cm&#179;</option>
        </select>)
      </th>
      <th>
        <span class="math"><i>q</i></span>
        <span class="math">(<i>e</i>)</span>
      </th>
    </tr>

    <tr id="site_row_1">
      <td> 1 </td>
      <td> <input type="text" size="10" value="3.15" id="sigma_1"> </td>
      <td> <input type="text" size="10" value="76.5364" id="eps6_1" onchange="change_eps6(1, '')"> </td>
      <td> <input type="text" size="10" value="76.5364" id="eps12_1" disabled>
        <input type="checkbox" id="sameeps_1" checked onchange="change_eps6(1, '')">
        Same as <span class="math"><i>&epsilon;</i><sub>&#8326;</sub></span>
      </td>
      <td> <input type="text" size="14" value="0.033314" id="rho_1"> </td>
      <td> <input type="text" size="10" value="-0.834" id="charge_1"> </td>
    </tr>

    <tr id="site_row_2">
      <td> 2 </td>
      <td> <input type="text" size="10" value="0.4" id="sigma_2"> </td>
      <td> <input type="text" size="10" value="0" id="eps6_2" onchange="change_eps6(2, '')"> </td>
      <td> <input type="text" size="10" value="23.1509" id="eps12_2">
        <input type="checkbox" id="sameeps_2" onchange="change_eps6(2, '')">
        Same as <span class="math"><i>&epsilon;</i><sub>&#8326;</sub></span>
      </td>
      <td> <input type="text" size="14" value="0.033314" id="rho_2"> </td>
      <td> <input type="text" size="10" value="0.417" id="charge_2"> </td>
    </tr>

    <tr id="site_row_3">
      <td> 3 </td>
      <td> <input type="text" size="10" value="0.4" id="sigma_3"> </td>
      <td> <input type="text" size="10" value="0" id="eps6_3" onchange="change_eps6(3, '')"> </td>
      <td> <input type="text" size="10" value="23.1509" id="eps12_3">
        <input type="checkbox" id="sameeps_3" onchange="change_eps6(3, '')">
        Same as <span class="math"><i>&epsilon;</i><sub>&#8326;</sub></span>
      </td>
      <td> <input type="text" size="14" value="0.033314" id="rho_3"> </td>
      <td> <input type="text" size="10" value="0.417" id="charge_3"> </td>
    </tr>

  </table>
  <br>


  <hr>
  Number of special interactions:
  <input type="text" size="8" value="0" id="npairs"
    onchange="change_npairs()">
  <br>
  <table id="pairTable">
    <tr id="pairTableHeader">
      <th>
        Site <span class="math"><i>i</i></span>
      </th>
      <th>
        Site <span class="math"><i>j</i></span>
      </th>
      <th>
        <span class="math" title="C&#8326; / r&#8310;"><i>C</i><sub>&#8326;</sub></span>
        (<select id="pairunit_C6" disabled>
          <option value="reduced">reduced</option>
          <option value="K" selected>K&sdot;&#197;&#8310;</option>
          <option value="erg">erg&sdot;&#197;&#8310;</option>
          <option value="kJpermol">kJ&sdot;&#197;&#8310;/mol</option>
          <option value="kcalpermol">kcal&sdot;&#197;&#8310;/mol</option>
        </select>)<br>
      </th>
      <th>
        <span class="math" title="C&#8321;&#8322; / r&#185;&#178;"><i>C</i><sub>&#8321;&#8322;</sub></span>
        (<select id="pairunit_C12" disabled>
          <option value="reduced">reduced</option>
          <option value="K" selected>K&sdot;&#197;&#185;&#178;</option>
          <option value="erg">erg&sdot;&#197;&#185;&#178;</option>
          <option value="kJpermol">kJ&sdot;&#197;&#185;&#178;/mol</option>
          <option value="kcalpermol">kcal&sdot;&#197;&#185;&#178;/mol</option>
        </select>)<br>
      </th>
      <th>
        <span class="math"><i>&sigma;</i></span>
        (&#197;)
      </th>
      <th>
        <span class="math"><i>&epsilon;</i><sub>&#8326;</sub></span>
        (<select id="pairunit_eps6" disabled>
          <option value="reduced">reduced</option>
          <option value="K" selected>K</option>
          <option value="erg">erg</option>
          <option value="kJpermol">kJ/mol</option>
          <option value="kcalpermol">kcal/mol</option>
        </select>)<br>
      </th>
      <th>
        <span class="math"><i>&epsilon;</i><sub>&#8321;&#8322;</sub></span>
        (<select id="pairunit_eps12" disabled>
          <option value="reduced">reduced</option>
          <option value="K" selected>K</option>
          <option value="erg">erg</option>
          <option value="kJpermol">kJ/mol</option>
          <option value="kcalpermol">kcal/mol</option>
        </select>)<br>
      </th>
      <th>
        <span class="math" title="for the Huggins-Mayer interionic potential"><i>&rho;</i></span>
        (&#197;)
      </th>
      <th>
        <span class="math" title="for the Huggins-Mayer interionic potential"><i>B</i></span>
        (<select id="pairunit_B" disabled>
          <option value="reduced">reduced</option>
          <option value="K" selected>K</option>
          <option value="erg">erg</option>
          <option value="kJpermol">kJ/mol</option>
          <option value="kcalpermol">kcal/mol</option>
        </select>)<br>
      </th>
    </tr>

  </table>
  <br>


  <hr>
  Number of chemical bonds:
  <input type="text" size="8" value="3" id="nbonds"
    onchange="change_nbonds()">
  <br>
  <table id="bondTable">
    <tr id="bondTableHeader">
      <th>
        Site <span class="math"><i>i</i></span>
      </th>
      <th>
        Site <span class="math"><i>j</i></span>
      </th>
      <th>
        Bond length
        <!-- <span class="math"><i>L<sub>i,j</sub></i></span> -->
        (&#197;)
      </th>
    </tr>

    <tr id="bond_row_1">
      <td> <input type="text" size="10" value="1" id="bondi_1"> </td>
      <td> <input type="text" size="10" value="2" id="bondj_1"> </td>
      <td> <input type="text" size="14" value="1.0" id="bondlen_1"> </td>
    </tr>

    <tr id="bond_row_2">
      <td> <input type="text" size="10" value="1" id="bondi_2"> </td>
      <td> <input type="text" size="10" value="3" id="bondj_2"> </td>
      <td> <input type="text" size="14" value="1.0" id="bondlen_2"> </td>
    </tr>

    <tr id="bond_row_3">
      <td> <input type="text" size="10" value="2" id="bondi_3"> </td>
      <td> <input type="text" size="10" value="3" id="bondj_3"> </td>
      <td> <input type="text" size="14" value="1.633" id="bondlen_3"> </td>
    </tr>

  </table>
  <br>

  <hr>
  Temperature:
  <input type="text" size="6" value="300" id="temp">
  K
  <br>

  Short-range interaction:
  <select id="ljtype">
    <option value="Hard-sphere">Hard-sphere interaction</option>
    <option value="LJ-repulsive">Repulsive part of Lennard-Jones interaction</option>
    <option value="LJ-full" selected>Full Lennard-Jones interaction</option>
  </select>
  <br>

  </div> <!-- Panel system -->

  <div class="panel">
  <div class="panel-title">Solver</div>

  Closure:
  <select id="ietype">
    <option value="PY">Percus-Yevick (PY)</option>
    <option value="HNC" selected>Hypernetted-chain (HNC)</option>
    <option value="KH">Kovalenko-Hirata (KH)</option>
  </select>
  <br>

  Radius cutoff,
  <span class="math"><i>r</i><sub>max</sub></span>:
  <input type="text" size="6" value="20.48" id="rmax">
  &#197;
  <br>

  Number of sampling points along
  <span class="math"><i>r</i></span>:
  <input type="text" size="6" value="1024" id="npt">
  <sub>(optimally, this should be a power of 2.)</sub>
  <br>

  The program gradually turns on the long range interaction.<br>
  The number of stages to turn on the full interaction:
  <span class="math"><i>N</i><sub>&lambda;</sub></span>:
  <input type="text" size="6" value="10" id="nlambdas">
  <br>

  Screening radius for electrostatic interaction,
  <span class="math"><i>r</i><sub>screen</sub></span>:
  <input type="text" size="6" value="1.0" id="rscreen">
  &#197;
  <br>

  Maximal number of iterations:
  <input type="text" size="6" value="100000" id="itmax">
  <br>

  Tolerance of the relative error:
  <input type="text" size="6" value="1e-7" id="tol">
  <br>

  <hr>

  Solver:
  <select id="solver">
    <option value="Picard">Picard (direct) iteration</option>
    <option value="LMV">Lab&iacute;k-Malijevsk&yacute;-Vonka (LMV) method (partial Newton-Raphson iteration)</option>
    <option value="MDIIS" selected>Modified direct inversion of the iterative subspace (MDIIS) method</option>
  </select>
  <br>

  <b>Picard iteration:</b>
  <span title="fraction of the old solution">Damping factor</span>:
  <input type="text" size="6" value="0.01" id="picard_damp">.
  &nbsp;
  <br>

  <b><abbr title="Lab&iacute;k-Malijevsk&yacute;-Vonka method">LMV</abbr>:</b>
  <span title="fraction of the old solution">Damping factor</span>:
  <input type="text" size="6" value="0.5" id="lmv_damp">.
  &nbsp;

  Number of
  <span class="math"><i>k</i></span> for the Newton-Raphson solver,
  <span class="math"><i>M</i></span>:
  <input type="text" size="6" value="25" id="lmv_M">
  <br>

  <b><abbr title="Modified direct inversion of the iterative subspace method">MDIIS</abbr>:</b>
  <span title="fraction of the old solution">Damping factor</span>:
  <input type="text" size="6" value="0.5" id="mdiis_damp">.
  &nbsp;

  Number of bases:
  <input type="text" size="6" value="5" id="mdiis_nbases">
  <br>

  <hr>

  How to handle solute-solute interaction?
  <select id="douu">
    <option value="Atomic" selected>Only for atomic solutes</option>
    <option value="Never">Never</option>
    <option value="Always">Always</option>
    <option value="All-solvent">Treat all atoms as solute.</option>
  </select>
  <br>

  Maximal magnitude of <span class="math"><i>c</i>(<i>r</i>)</span>:
  <input type="text" size="6" value="1e30" id="crmax">

  </div>  <!-- Panel solver -->

  <div class="center">
  <input type="button" value="Generate configuration file"
    id="gencfgbtn" onclick="gencfg()" class="largebtn">

  <input type="reset" value="Reset"
    id="resetbtn" class="largebtn">

  </div> <!-- array of buttons -->

  <br>

  <div>
    Output configuration file:<br>
  <textarea rows="10" id="cfgout"></textarea>
  </div>
</form>



<div class="panel">
<h2 class="panel-title">
  The XRISM program <span class="code">rism0</span>
</h2>

<p>
The program <span class="code">rism0</span>
solves the integral equation for a molecular fluid.

It is written in C.

The latest version of <span class="code">rism0</span>
can be found in
<ul>
  <li>
    <a href="https://github.com/3ki5tj/rism">
      Github
    </a> (source code only)
  </li>
  <li>
    <a href="https://www.dropbox.com/sh/85y8gnm40hfspo1/AADyeYAYAYnmfvGTo6hVhksga?dl=0">
      Dropbox link </a>
    (including references, data files, etc.)
  </li>
</ul>

<p>
XRISM is an advanced integral equation.
For an introduction of integral equation,
see <a href="ie.html">this demonstration</a>.

<p>
Normally, the program produces an output file
<span class="code">out.dat</span>.
<a href="../doc/pmfs.pdf">This note</a> contains information on how to use the output
to compute various potentials of mean force.

</div>



<div class="panel">
<h2 class="panel-title">References</h2>

<p>
The program <span class="code">rism0</span>
was used to reproduce some figures in several classic papers of XRISM:
<ul>
<li><a href="./mkpapers/hrp1983.html">HRP1983</a>:
The Interionic potential of mean force in a molecular polar solvent from an extended RISM equation
Fumio Hirata, Peter J. Rossky, and B. Montgomery Pettitt
J. Chem. Phys. 78(6) 4133-4144 (1983).

<li><a href="./mkpapers/pk1985.html">PK1985</a>:
The potential of mean force between polyatomic molecular in polar molecular solvents,
B. Montgomery Pettit and Martin Karplus,
J. Chem. Phys. 83(2), 781-789 (1985).

<li><a href="./mkpapers/pr1986.html">PR1986</a>:
Alkali halides in water: Ion-solvent correlations and ion-ion potentials of mean force at infinite dilution,
B. Montgomery Pettitt and Peter J. Rossky,
J. Chem. Phys. 84(10) 5836-5844 (1986)

</ul>

</div>


</body>
</html>
